{% extends "screen_base.html" %}
{% block basecontent %}
 
<style>
    :root {
        --team-bg-color: {{team_color}};
    }

    body {
        font-family: GlacialIndifference;
        background-color:rgb(37, 37, 37);
        margin: 0; /* this prevents a small bleed on the screen I guess? */
    }

    @font-face {
        font-family: 'GlacialIndifference';
        src: url('{{url_for('user_screens.static', filename='GlacialIndifference-Regular.woff')}}') format('woff');
        font-style: normal;
        font-weight: 400;
    }

    @font-face {
        font-family: 'GlacialIndifference';
        src: url('{{url_for('user_screens.static', filename='GlacialIndifference-Bold.woff')}}') format('woff');
        font-style: bold;
        font-weight: 700;
    }

    body {
        width: 100vw;
        height: 100vh;
        overflow: hidden;
    }
    .timer {
        font-family: DSEG14;
        color:white;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100%;
    }

    .tophalf {
        width: 100%;
        max-height:100%;
        height:50%;
        margin: 0 auto;
         padding: 10px;
        position: relative;
    }

    .bottomhalf {
        height:50vh;
    }
    /* CSS Button for teams to press */
    .fancybutton {
        background-color: #04AA6D; /* Green */
        border: none;
        color: white;
        text-align: center;
        text-decoration: none;
        font-size: clamp(1rem, 9cqi, 14rem);
        font-family: GlacialIndifference;
        font-weight: 600;
        width: 100%;
        height: 100%;
    }

    .buttons {
        height:50%; /* this ensures the button groups only use up half the screen real estate. */
    }

    .tapout {
        background-color: white; 
        color: #111; 
        font-weight: bold;
    }

    .readyup { /* not yet used, unsure how to style best. */

    }
    </style>

<script> //user interaction stubs.
    function ready() {
        socket.emit('player_ready', window.location);
        document.getElementById("readybutton").innerText = "READIED";
    }

    function tapout() {
        socket.emit('player_tapout', window.location);
        document.getElementById("tapoutbutton").innerText = "TAPPED"
    }
</script>


<div class="tophalf">
    <div class="timer" id="timer">
        000
    </div>
  </div>

  <div class="bottomhalf">
        <div class="buttons">
            <button id="tapoutbutton" onclick="tapout()" class="fancybutton tapout" style=>TAP OUT</button>
            <button id="readybutton" onclick="ready()" class="fancybutton readyup">MARK READY</button>
        </div>
</div>

    
<script>
    function setTimerString(timer_value) {
        document.getElementById("timer").innerHTML = timer_value;
        textFit(document.getElementsByClassName('timer'), {alignHoriz: true, maxFontSize: 600, widthOnly: true, detectMultiLine: false});
    };

    // sometimes there's a race condition for the font loading, so this may have to be reset after initial load.
    setTimerString("000");
    setTimerString("000");
</script>

<script type="text/javascript" charset="utf-8">
var socket = io();

socket.on("timer_event", function(timer_data) {
    setTimerString(timer_data);
});

socket.on("reset_screen_states", function() {
        document.getElementById("readybutton").innerText = "MARK READY";
        document.getElementById("tapoutbutton").innerText = "TAP OUT"
});

</script>
{% endblock %}
